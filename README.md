# TStack Kit

> **Rails-like backend toolkit for Deno. Build APIs fast.**

A minimal, production-ready starter for building type-safe REST APIs with Deno, Hono, Drizzle ORM, and PostgreSQL.

---

## Features

- ⚡ **Fast Setup** - Create new projects in seconds
- 🎯 **CLI Scaffolding** - Generate complete MVC entities with one command
- 🔒 **Type-Safe** - Full TypeScript with Drizzle ORM
- 🗄️ **PostgreSQL** - Production-ready from day 1
- 🐳 **Docker Ready** - Includes docker-compose setup
- 🎨 **Clean MVC** - Organized entity structure
- 📦 **Minimal** - No auth bloat, add what you need

---

## Quick Start

### 1. Install Deno

```bash
curl -fsSL https://deno.land/install.sh | sh
```

### 2. Install TStack CLI

```bash
# Clone the repo
git clone https://github.com/desingh-rajan/tstack-kit.git
cd tstack-kit

# Install CLI globally
cd packages/cli
deno task install
```

### 3. Create Your First Project

```bash
# Create new project
tstack create blog-api
cd blog-api

# Setup environment
cp .env.example .env

# Start PostgreSQL
docker-compose up -d postgres

# Run migrations
deno task migrate:run

# Start dev server
deno task dev
```

Server running at **http://localhost:8000** ✨

---

## Scaffold Entities

Generate complete MVC structures:

```bash
# Scaffold articles entity
tstack scaffold articles

# This creates:
# ✓ src/entities/articles/article.model.ts    (Drizzle schema)
# ✓ src/entities/articles/article.dto.ts      (Zod validation)
# ✓ src/entities/articles/article.service.ts  (Business logic)
# ✓ src/entities/articles/article.controller.ts (HTTP handlers)
# ✓ src/entities/articles/article.route.ts    (Hono routes)
```

### Customize the Model

Edit `src/entities/articles/article.model.ts`:

```typescript
import { pgTable, integer, text, timestamp, boolean } from "drizzle-orm/pg-core";

export const articles = pgTable("articles", {
  id: integer().primaryKey().generatedAlwaysAsIdentity(),
  title: text().notNull(),
  content: text(),
  published: boolean().default(false),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});
```

### Register Routes

Edit `src/main.ts`:

```typescript
import articleRoutes from "./entities/articles/article.route.ts";

app.route("/api", articleRoutes);
```

### Run Migrations

```bash
deno task migrate:generate
deno task migrate:run
```

---

## Project Structure

```
my-project/
├── src/
│   ├── main.ts              # App entry point
│   ├── config/
│   │   ├── database.ts      # PostgreSQL connection
│   │   └── env.ts           # Environment config
│   ├── entities/            # Your domain entities
│   │   └── articles/        # Generated by scaffold
│   └── shared/
│       ├── middleware/      # Error handling, logging
│       └── utils/           # Response, validation helpers
├── migrations/              # Drizzle migrations
├── tests/                   # Test structure
├── deno.json               # Deno configuration
├── drizzle.config.ts       # Drizzle config
├── docker-compose.yml      # PostgreSQL setup
└── .env.example            # Environment template
```

---

## Available Commands

### TStack CLI

```bash
tstack create <project>     # Create new project
tstack scaffold <entity>    # Generate entity
tstack --help              # Show help
tstack --version           # Show version
```

### Project Commands

```bash
deno task dev              # Start development server (with watch)
deno task start            # Start production server
deno task migrate:generate # Generate migrations
deno task migrate:run      # Run migrations
deno task db:studio        # Open Drizzle Studio
deno task test             # Run tests
deno task fmt              # Format code
deno task lint             # Lint code
```

---

## Tech Stack

| Layer      | Technology | Version |
|------------|------------|---------|
| Runtime    | Deno       | 2.5.4+  |
| Framework  | Hono       | 4.6.3   |
| ORM        | Drizzle    | 0.33.0  |
| Database   | PostgreSQL | 16+     |
| Validation | Zod        | 3.23.0  |

---

## Environment Variables

```bash
# .env
NODE_ENV=development
PORT=8000
DATABASE_URL=postgresql://tonystack:password@localhost:5432/tonystack
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
LOG_LEVEL=info
```

---

## Docker Deployment

### Development

```bash
docker-compose up -d
```

### Production

Set environment variables:

```bash
export NODE_ENV=production
export DATABASE_URL=postgresql://user:pass@host:5432/db
```

Then:

```bash
docker-compose --profile prod up -d
```

---

## What You Get

### Default Endpoints

- `GET /` - API information
- `GET /health` - Health check

### Scaffolded Entity Endpoints

After `tstack scaffold articles`:

- `GET /api/articles` - List all
- `GET /api/articles/:id` - Get one
- `POST /api/articles` - Create
- `PUT /api/articles/:id` - Update
- `DELETE /api/articles/:id` - Delete

---

## Example: Building a Blog API

```bash
# 1. Create project
tstack create blog-api && cd blog-api

# 2. Start PostgreSQL
docker-compose up -d postgres

# 3. Scaffold entities
tstack scaffold articles
tstack scaffold comments
tstack scaffold categories

# 4. Customize models
# Add title, content, etc. to article.model.ts

# 5. Register routes in main.ts
# 6. Run migrations
deno task migrate:generate
deno task migrate:run

# 7. Start server
deno task dev
```

Done! You have a working blog API. 🎉

---

## Why TStack?

### For You

- ✅ **Zero auth bloat** - Add authentication when YOU need it
- ✅ **PostgreSQL first** - No SQLite native binding issues
- ✅ **Minimal defaults** - Clean starting point
- ✅ **Pure Deno** - No Node.js baggage
- ✅ **Fast** - Generate entities in seconds

### Not For You If

- ❌ You want batteries-included auth (add it yourself!)
- ❌ You need GraphQL (REST only)
- ❌ You want an all-in-one framework (this is a toolkit)

---

## Development Workflow

1. **Create** - `tstack create my-api`
2. **Scaffold** - `tstack scaffold products`
3. **Customize** - Edit models, add fields
4. **Migrate** - `deno task migrate:run`
5. **Test** - `curl http://localhost:8000/api/products`
6. **Deploy** - `docker-compose up -d`

---

## Roadmap

### v1.0 (Current)
- ✅ PostgreSQL support
- ✅ Entity scaffolding
- ✅ Docker ready
- ✅ Minimal starter

### v1.1 (Next)
- [ ] `tstack destroy` command
- [ ] Database choice flag (`--db=postgres|mysql`)
- [ ] Auth plugin (optional addon)

### v2.0 (Future)
- [ ] Testing utilities
- [ ] File upload helpers
- [ ] WebSocket support
- [ ] Admin dashboard generator

---

## Contributing

Found a bug? Want to add a feature?

1. Fork the repo
2. Create a feature branch
3. Submit a pull request

---

## License

MIT License - Free for personal and commercial use.

---

## Links

- **GitHub**: https://github.com/desingh-rajan/tstack-kit
- **Issues**: https://github.com/desingh-rajan/tstack-kit/issues
- **Deno**: https://deno.land
- **Hono**: https://hono.dev
- **Drizzle**: https://orm.drizzle.team

---

**Built with ❤️ for the Deno community**

Clean, Fast, Simple.
